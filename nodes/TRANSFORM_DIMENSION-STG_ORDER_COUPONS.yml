steps:
  STG_ORDER_COUPONS-6726c6c7-5c62-4d27-bffa-e2de629e0994:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationName: TRANSFORM_DIMENSION
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: ac5dcb68-bfb5-4a2d-a40a-c2eeb08c5f06
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: VARCHAR(16777216)
            description: ""
            name: OP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dca53ebe-b74a-489d-adab-58f0859de630
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 04f52a0f-fb2b-4cfc-8200-ac8c38ebbd1d
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: TIMESTAMP_TRACK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 99ad4495-69a1-4998-a70d-6daeaf0086bc
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 5ac438d0-fc55-440e-be79-fba6c1da0444
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: VARCHAR(16777216)
            description: ""
            name: ORDERCOUPONID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 25f888ae-8a47-4d5e-9bae-3db24a5a29b8
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 3733f4ce-46c9-481b-be2c-6e4f8e261919
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: VARCHAR(16777216)
            description: ""
            name: ORDERID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2f1e633b-6946-4006-b1fd-f2cd82fd87ea
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: ea7bc6ba-75aa-4909-a53e-18ba2b0cf32f
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: VARCHAR(16777216)
            description: ""
            name: COUPONID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d17ad99c-73b2-4bfc-a731-7018ec2bc6fa
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 9add4cb6-fbd8-4dce-b784-21aceddf1d95
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: VARCHAR(16777216)
            description: ""
            name: COUPONNAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 83afa25a-4f06-48cb-963b-1e608bcc88c1
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 79f1dcec-a77c-43cc-8746-e7ff1a1b70d2
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: VARCHAR(16777216)
            description: ""
            name: COUPONCODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3039a4f9-13ea-48a5-adfd-620cf4979540
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: e3cc8a10-9ff5-4a59-85bc-f040ae734a52
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: BOOLEAN
            description: ""
            name: INUSE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0696bfb0-a01a-468a-b8c2-746a10f86fb9
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 98f4c22c-2f94-4fb2-9052-1432dc4c0ede
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: NUMBER(18,2)
            description: ""
            name: PRODUCTVALUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5cc2c29f-19ec-47c0-9faf-2f2dcfa7bad5
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 83d8d18d-ddb5-4a0e-ae54-99c2c2a59fcb
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: NUMBER(18,2)
            description: ""
            name: SHIPPINGVALUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ca6d2a51-c48c-4b74-b467-42d89d1cd7a9
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 7b48166a-58a6-46b6-aad3-4a24f2ca3d5c
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: NUMBER(18,2)
            description: ""
            name: TOTALVALUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 036518ad-c524-4366-8014-0af1842a6031
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 04f53297-b434-4dcb-b27f-bb71aa7a69be
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: VARCHAR(16777216)
            description: ""
            name: AFFECTEDORDERITEMIDS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 867516fa-3b82-4a0d-8d6e-33f1bd3b8aee
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: bf376543-28a4-4efb-a011-fa5f2b669dfc
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: NUMBER(18,2)
            description: ""
            name: PRODUCTVALUEPERDOLLAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c07e3f54-b0aa-49e0-a550-ccd1fcfa61a2
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 0f71ee1b-ecc1-471b-af1f-3c24af256019
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: NUMBER(18,2)
            description: ""
            name: SHIPPINGVALUEPERDOLLAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9094fb3f-554b-4f3a-ab4b-77bfab939ceb
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: 36cf907f-52e1-42cb-bf24-f336cf52e467
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: DATEADDED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: baf0c9be-9dd9-49ed-bbd6-411915bee028
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - columnReference:
              columnCounter: d228af6e-85f7-4cb1-9fc2-f46fc86c42c2
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            dataType: VARCHAR(16777216)
            description: ""
            name: DATA_SOURCE_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fd585fb2-4ec6-4293-b236-66b2d7312a07
                    stepCounter: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 846d9879-90c3-4f43-ab7f-9c1da7d93951
              stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: CURRENT_RECORD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: row_number() over (partition by ORDERCOUPONID order by DATEADDED DESC)
            systemColumnType: None
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              ORDER_COUPONS_DELTA_DATA: 2355f2b5-2a06-4eec-aa30-5bf9ac7dc743
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCES_ECOMMERCE_EXTENDED_CWD
                nodeName: ORDER_COUPONS_DELTA_DATA
            join:
              joinCondition: |-
                FROM {{ ref('SOURCES_ECOMMERCE_EXTENDED_CWD', 'ORDER_COUPONS_DELTA_DATA') }} "ORDER_COUPONS_DELTA_DATA"
                QUALIFY CURRENT_RECORD = 1
            name: STG_ORDER_COUPONS
            noLinkRefs: []
      name: STG_ORDER_COUPONS
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 6726c6c7-5c62-4d27-bffa-e2de629e0994
