steps:
  T_FACT_FULFILLMENT_ORDER_HEADER-5639:
    operation:
      config:
        postSQL: ""
        preSQL: ""
        testsEnabled: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: PRESENTATION_FACT
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: "624463"
              stepCounter: "5639"
            dataType: NUMBER
            description: ""
            name: CARRIER_SK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624053"
                    stepCounter: "5640"
                transform: ""
          - columnReference:
              columnCounter: "624464"
              stepCounter: "5639"
            dataType: NUMBER
            description: ""
            name: ZONE_SK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624440"
                    stepCounter: "5651"
                transform: ""
          - columnReference:
              columnCounter: "624650"
              stepCounter: "5639"
            dataType: NUMBER
            description: ""
            name: CLIENT_SK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624636"
                    stepCounter: "5655"
                transform: ""
          - columnReference:
              columnCounter: "624016"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: ORDER_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624124"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624017"
              stepCounter: "5639"
            dataType: VARCHAR(240)
            description: ""
            hashDetails: null
            name: ORDER_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624125"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624018"
              stepCounter: "5639"
            dataType: VARCHAR(240)
            description: ""
            hashDetails: null
            name: BILL_ORDER_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624126"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624019"
              stepCounter: "5639"
            dataType: VARCHAR(50)
            description: ""
            hashDetails: null
            name: CUSTOMER_ORDER_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624127"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624020"
              stepCounter: "5639"
            dataType: VARCHAR(80)
            description: ""
            hashDetails: null
            name: TRACKING_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624128"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624021"
              stepCounter: "5639"
            dataType: VARCHAR(3)
            description: ""
            hashDetails: null
            name: SHIP_FROM_FULFILLMENT_CENTER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624130"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624022"
              stepCounter: "5639"
            dataType: varchar
            description: ""
            hashDetails: null
            isBusinessKey: true
            name: PACKAGE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624129"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624649"
              stepCounter: "5639"
            dataType: VARCHAR(360)
            description: ""
            name: CLIENT_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624637"
                    stepCounter: "5655"
                transform: ""
          - columnReference:
              columnCounter: "624023"
              stepCounter: "5639"
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashDetails: null
            name: SHIP_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624131"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624024"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: PACKAGE_WEIGHT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624132"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624025"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: FULFILLMENT_AND_SHIPPING
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624133"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624026"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: TIER_DELIVERY_SERVICES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624134"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624027"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: LINE_HAUL_SERVICES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624135"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624028"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: FULFILLMENT_FUEL_SURCHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624136"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624029"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: LINE_HAUL_FUEL_SURCHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624137"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624030"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: ADDITIONAL_INSERT_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624138"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624031"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: GREETING_CARD_CHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624139"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624032"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: WILL_CALL_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624140"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624033"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SPECIAL_ORDER_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624141"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624034"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: PACKAGING_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624142"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624035"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: CUSTOM_PACKAGING
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624143"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624036"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: FOAM_PACKING_REQUIRED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624144"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624037"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: COOLPACK_PACKAGING_REQUESTED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624145"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624038"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: LIABILITY_COVERAGE_CHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624146"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624039"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: OTHER_CHARGES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624147"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624040"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: TOTAL
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624148"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624041"
              stepCounter: "5639"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: WINE_BOTTLES_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624149"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624042"
              stepCounter: "5639"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: GIFT_SETS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624150"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624043"
              stepCounter: "5639"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: OTHER_ITEMS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624151"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624044"
              stepCounter: "5639"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: TOTAL_ITEMS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624152"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624045"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SHIP_TO_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624153"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624046"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SHIP_FROM_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624154"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624047"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SERVICE_LEVEL_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624155"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624048"
              stepCounter: "5639"
            dataType: VARCHAR
            description: ""
            hashDetails: null
            name: CARRIER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624156"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624049"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SHIPPING_ZONE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624157"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624487"
              stepCounter: "5639"
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: SLA_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624485"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624488"
              stepCounter: "5639"
            dataType: VARCHAR(30)
            description: ""
            name: STATUS_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624486"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624648"
              stepCounter: "5639"
            dataType: FLOAT
            description: ""
            name: SOLD_TO_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624647"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "624232"
              stepCounter: "5639"
            dataType: VARCHAR
            description: ONLY USED TO MAKE BUSINESS KEY
            isBusinessKey: true
            name: ALT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624231"
                    stepCounter: "5641"
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "624050"
              stepCounter: "5639"
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            isSystemCreateDate: true
            name: SYSTEM_CREATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "624051"
              stepCounter: "5639"
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            isSystemUpdateDate: true
            name: SYSTEM_UPDATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
          - columnReference:
              columnCounter: "624653"
              stepCounter: "5639"
            dataType: VARCHAR(30)
            description: ""
            name: PACKAGE_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624652"
                    stepCounter: "5641"
                transform: ""
          - columnReference:
              columnCounter: "625438"
              stepCounter: "5639"
            dataType: VARCHAR
            description: ""
            name: SHIP_TO_STATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625437"
                    stepCounter: "5641"
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              TMP_FACT_ORDER_HEADER: "5641"
              T_DIM_FULFILLMENT_CARRIERS: "5640"
              T_DIM_FULFILLMENT_ZONES: "5651"
              T_DIM_TMP_OMS_CLIENT: "5655"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: PRESENTATION_DIMENSION
                nodeName: T_DIM_FULFILLMENT_CARRIERS
              - locationName: TRANSFORM_FACT
                nodeName: TMP_FACT_ORDER_HEADER
              - locationName: PRESENTATION_DIMENSION
                nodeName: T_DIM_FULFILLMENT_ZONES
              - locationName: PRESENTATION_DIMENSION
                nodeName: T_DIM_TMP_OMS_CLIENT
            join:
              joinCondition: |-
                FROM {{ ref('TRANSFORM_FACT', 'TMP_FACT_ORDER_HEADER') }} "TMP_FACT_ORDER_HEADER"
                left join {{ ref('PRESENTATION_DIMENSION', 'T_DIM_FULFILLMENT_CARRIERS') }} "T_DIM_FULFILLMENT_CARRIERS"
                    on "T_DIM_FULFILLMENT_CARRIERS"."CARRIER_CODE" = "TMP_FACT_ORDER_HEADER"."CARRIER"
                    AND "T_DIM_FULFILLMENT_CARRIERS"."SERVICE_LEVEL_ID" = "TMP_FACT_ORDER_HEADER"."SERVICE_LEVEL_ID"
                    AND "T_DIM_FULFILLMENT_CARRIERS"."SYSTEM_CURRENT_FLAG" = 'Y'
                INNER JOIN {{ ref('PRESENTATION_DIMENSION', 'T_DIM_FULFILLMENT_ZONES') }} "T_DIM_FULFILLMENT_ZONES"
                    ON "T_DIM_FULFILLMENT_ZONES"."SHIPPING_ZONE_ID" = "TMP_FACT_ORDER_HEADER"."SHIPPING_ZONE_ID"
                    AND "T_DIM_FULFILLMENT_ZONES"."SYSTEM_CURRENT_FLAG" = 'Y'
                LEFT JOIN {{ ref('PRESENTATION_DIMENSION', 'T_DIM_TMP_OMS_CLIENT') }} "T_DIM_TMP_OMS_CLIENT"
                    ON "TMP_FACT_ORDER_HEADER"."SOLD_TO_ORGANIZATION_ID" = "T_DIM_TMP_OMS_CLIENT"."CUST_ACCOUNT_ID"
                    AND "T_DIM_TMP_OMS_CLIENT"."SYSTEM_CURRENT_FLAG" = 'Y'
            name: T_FACT_FULFILLMENT_ORDER_HEADER
            noLinkRefs: []
      name: T_FACT_FULFILLMENT_ORDER_HEADER
      overrideSQL: false
      schema: ""
      sqlType: Fact
      type: sql
    stepCounter: "5639"
