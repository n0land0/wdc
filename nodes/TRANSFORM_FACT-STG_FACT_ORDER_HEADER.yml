steps:
  STG_FACT_ORDER_HEADER-5630:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: TRANSFORM_FACT
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: "623780"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: ORDER_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "187800"
                    stepCounter: "5462"
                transform: ""
          - columnReference:
              columnCounter: "623643"
              stepCounter: "5630"
            dataType: VARCHAR(240)
            description: ""
            hashDetails: null
            name: ORDER_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "187663"
                    stepCounter: "5462"
                transform: ""
          - columnReference:
              columnCounter: "623658"
              stepCounter: "5630"
            dataType: VARCHAR(240)
            description: ""
            hashDetails: null
            name: BILL_ORDER_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: NVL("PSTG_OE_ORDER_HEADERS_ALL"."ATTRIBUTE7", "PSTG_OE_ORDER_HEADERS_ALL"."ATTRIBUTE2")
          - columnReference:
              columnCounter: "623673"
              stepCounter: "5630"
            dataType: VARCHAR(50)
            description: ""
            hashDetails: null
            name: CUSTOMER_ORDER_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "187693"
                    stepCounter: "5462"
                transform: ""
          - columnReference:
              columnCounter: "623875"
              stepCounter: "5630"
            dataType: VARCHAR(80)
            description: ""
            name: TRACKING_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186230"
                    stepCounter: "5451"
                transform: ""
          - columnReference:
              columnCounter: "623877"
              stepCounter: "5630"
            dataType: varchar
            description: ""
            name: PACKAGE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186238"
                    stepCounter: "5451"
                transform: ""
          - columnReference:
              columnCounter: "623878"
              stepCounter: "5630"
            dataType: VARCHAR(3)
            description: ""
            name: SHIP_FROM_FULFILLMENT_CENTER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "187168"
                    stepCounter: "5460"
                transform: ""
          - columnReference:
              columnCounter: "623876"
              stepCounter: "5630"
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: SHIP_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186216"
                    stepCounter: "5451"
                transform: ""
          - columnReference:
              columnCounter: "623879"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            name: PACKAGE_WEIGHT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186211"
                    stepCounter: "5451"
                transform: TRUNC("PSTG_XWS_SHIP_CONFIRM_HEADERS"."WEIGHT" + 0.99)
          - columnReference:
              columnCounter: "623799"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            name: FULFILLMENT_AND_SHIPPING
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION",'Fulfillment Pick/Pack ' || chr(38) || ' Shipping Charges', "PSTG_OE_ORDER_LINES_ALL"."UNIT_SELLING_PRICE",0))
          - columnReference:
              columnCounter: "623806"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            name: TIER_DELIVERY_SERVICES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", '3-Tier Delivery Services', "PSTG_OE_ORDER_LINES_ALL"."UNIT_SELLING_PRICE", '3-Tier Fulfillment Pick/Pack ' || chr(38) || ' Shipping Charges', "PSTG_OE_ORDER_LINES_ALL"."UNIT_SELLING_PRICE",0))
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623851"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: LINE_HAUL_SERVICES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Line Haul Services',"PSTG_OE_ORDER_LINES_ALL"."UNIT_SELLING_PRICE",0 ))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623852"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: FULFILLMENT_FUEL_SURCHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Fulfillment Fuel Surcharge', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623853"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: LINE_HAUL_FUEL_SURCHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Line Haul Fuel Surcharge',"PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE, '3-Tier Line Haul Fuel Surcharge', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623854"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: ADDITIONAL_INSERT_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Additional Insert Fee', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623855"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: GREETING_CARD_CHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Greeting Card Charge', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623856"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: WILL_CALL_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Will Call Fee', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE, 0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623857"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: SPECIAL_ORDER_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Special Order Fee', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0 ))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623858"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: PACKAGING_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Packaging Fee', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623859"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: CUSTOM_PACKAGING
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Custom Packaging', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623860"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: FOAM_PACKING_REQUIRED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Foam Packaging Requested', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0 ))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623861"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: COOLPACK_PACKAGING_REQUESTED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'CoolPack Packaging Requested', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623862"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: LIABILITY_COVERAGE_CHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE("STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION", 'Liability Coverage Charge', "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623863"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: OTHER_CHARGES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM(DECODE(REGEXP_INSTR('Fulfillment Pick/Pack ' || chr(38) || ' Shipping Charges 3-Tier Fulfillment Pick/Pack ' || chr(38) || ' Shipping Charges 3-Tier Delivery Services Line Haul Services 3-Tier Line Haul Services Fulfillment Fuel Surcharge Line Haul Fuel Surcharge 3-Tier Line Haul Fuel Surcharge Additional Insert Fee Will Call Fee Greeting Card Charge Custom Packaging CoolPack Packaging Requested Foam Packaging Requested Special Order Fee Liability Coverage Charge', "STG_DIM_PRODUCTS_INVENTORY"."DESCRIPTION",1,1),0, "PSTG_OE_ORDER_LINES_ALL".UNIT_SELLING_PRICE,0))
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623864"
              stepCounter: "5630"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: TOTAL
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUM("PSTG_OE_ORDER_LINES_ALL"."UNIT_SELLING_PRICE")
            systemColumnType: None
            transform: ""
          - columnReference:
              columnCounter: "624416"
              stepCounter: "5630"
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: SLA_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186134"
                    stepCounter: "5448"
                transform: ""
          - columnReference:
              columnCounter: "624417"
              stepCounter: "5630"
            dataType: VARCHAR(30)
            description: ""
            name: STATUS_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186136"
                    stepCounter: "5448"
                transform: ""
          - columnReference:
              columnCounter: "623865"
              stepCounter: "5630"
            dataType: NUMBER(38,0)
            description: ""
            name: WINE_BOTTLES_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623843"
                    stepCounter: "5631"
                transform: ""
          - columnReference:
              columnCounter: "623866"
              stepCounter: "5630"
            dataType: NUMBER(38,0)
            description: ""
            name: GIFT_SETS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623844"
                    stepCounter: "5631"
                transform: ""
          - columnReference:
              columnCounter: "623867"
              stepCounter: "5630"
            dataType: NUMBER(38,0)
            description: ""
            name: OTHER_ITEMS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623845"
                    stepCounter: "5631"
                transform: ""
          - columnReference:
              columnCounter: "623868"
              stepCounter: "5630"
            dataType: NUMBER(38,0)
            description: ""
            name: TOTAL_ITEMS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623846"
                    stepCounter: "5631"
                transform: ""
          - columnReference:
              columnCounter: "623870"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            name: SHIP_TO_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "187740"
                    stepCounter: "5462"
                transform: ""
          - columnReference:
              columnCounter: "623871"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            name: SHIP_FROM_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "187775"
                    stepCounter: "5462"
                transform: ""
          - columnReference:
              columnCounter: "624651"
              stepCounter: "5630"
            dataType: VARCHAR(30)
            description: ""
            name: PACKAGE_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186232"
                    stepCounter: "5451"
                transform: ""
          - columnReference:
              columnCounter: "623872"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            name: SERVICE_LEVEL_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186208"
                    stepCounter: "5451"
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "623873"
              stepCounter: "5630"
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: CARRIER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUBSTR("PSTG_XWS_SHIP_CONFIRM_HEADERS"."CARRIER_3",1,8)
            systemColumnType: None
            transform: ""
          - columnReference:
              columnCounter: "623874"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            name: SHIPPING_ZONE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "186239"
                    stepCounter: "5451"
                transform: ""
          - columnReference:
              columnCounter: "624646"
              stepCounter: "5630"
            dataType: FLOAT
            description: ""
            name: SOLD_TO_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "187791"
                    stepCounter: "5462"
                transform: ""
          - columnReference:
              columnCounter: "625435"
              stepCounter: "5630"
            dataType: VARCHAR
            description: ""
            name: SHIP_TO_STATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624327"
                    stepCounter: "5645"
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              PSTG_ERP_ORDER_SLAS: "5448"
              PSTG_MTL_PARAMETERS: "5460"
              PSTG_OE_ORDER_HEADERS_ALL: "5462"
              PSTG_OE_ORDER_LINES_ALL: "5463"
              PSTG_WEB_ORDER_HEADERS: "5464"
              PSTG_XWS_SHIP_CONFIRM_HEADERS: "5451"
              STG_DIM_FULFILLMENT_CONSUMER: "5645"
              STG_DIM_PRODUCTS_INVENTORY: "5552"
              TAB_ITEM_COUNT: "5631"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: PERSISTENT_STAGING_ORACLE
                nodeName: PSTG_ERP_ORDER_SLAS
              - locationName: PERSISTENT_STAGING_ORACLE
                nodeName: PSTG_XWS_SHIP_CONFIRM_HEADERS
              - locationName: PERSISTENT_STAGING_ORACLE
                nodeName: PSTG_MTL_PARAMETERS
              - locationName: PERSISTENT_STAGING_ORACLE
                nodeName: PSTG_OE_ORDER_HEADERS_ALL
              - locationName: PERSISTENT_STAGING_ORACLE
                nodeName: PSTG_OE_ORDER_LINES_ALL
              - locationName: PERSISTENT_STAGING_ORACLE
                nodeName: PSTG_WEB_ORDER_HEADERS
              - locationName: TRANSFORM_DIMENSION
                nodeName: STG_DIM_PRODUCTS_INVENTORY
              - locationName: TRANSFORM_FACT
                nodeName: TAB_ITEM_COUNT
              - locationName: TRANSFORM_DIMENSION
                nodeName: STG_DIM_FULFILLMENT_CONSUMER
            join:
              joinCondition: |-
                FROM {{ ref('PERSISTENT_STAGING_ORACLE', 'PSTG_OE_ORDER_HEADERS_ALL') }} "PSTG_OE_ORDER_HEADERS_ALL"
                JOIN {{ ref('PERSISTENT_STAGING_ORACLE', 'PSTG_OE_ORDER_LINES_ALL') }} "PSTG_OE_ORDER_LINES_ALL"
                    ON "PSTG_OE_ORDER_HEADERS_ALL"."HEADER_ID" = "PSTG_OE_ORDER_LINES_ALL"."HEADER_ID" 
                    AND "PSTG_OE_ORDER_LINES_ALL"."CANCELLED_FLAG" = 'N'
                    AND "PSTG_OE_ORDER_LINES_ALL"."SYSTEM_CURRENT_FLAG" = 'Y'
                JOIN {{ ref('PERSISTENT_STAGING_ORACLE', 'PSTG_WEB_ORDER_HEADERS') }} "PSTG_WEB_ORDER_HEADERS"
                    ON "PSTG_WEB_ORDER_HEADERS"."OM_HEADER_ID" = "PSTG_OE_ORDER_HEADERS_ALL"."HEADER_ID"
                    AND "PSTG_WEB_ORDER_HEADERS"."SYSTEM_CURRENT_FLAG" = 'Y'
                JOIN {{ ref('PERSISTENT_STAGING_ORACLE', 'PSTG_XWS_SHIP_CONFIRM_HEADERS') }} "PSTG_XWS_SHIP_CONFIRM_HEADERS"
                    ON "PSTG_XWS_SHIP_CONFIRM_HEADERS"."ORDER_ID" = "PSTG_OE_ORDER_HEADERS_ALL"."ORDER_NUMBER"
                    AND "PSTG_XWS_SHIP_CONFIRM_HEADERS"."SHIP_CONFIRM_ID" = "PSTG_OE_ORDER_LINES_ALL"."INDUSTRY_ATTRIBUTE1"
                    AND "PSTG_XWS_SHIP_CONFIRM_HEADERS"."SYSTEM_CURRENT_FLAG" = 'Y'
                JOIN {{ ref('TRANSFORM_FACT', 'TAB_ITEM_COUNT') }} "TAB_ITEM_COUNT"
                    ON "TAB_ITEM_COUNT"."SHIP_CONFIRM_ID" = "PSTG_XWS_SHIP_CONFIRM_HEADERS"."SHIP_CONFIRM_ID"
                JOIN {{ ref('TRANSFORM_DIMENSION', 'STG_DIM_PRODUCTS_INVENTORY') }} "STG_DIM_PRODUCTS_INVENTORY"
                    ON "STG_DIM_PRODUCTS_INVENTORY"."INVENTORY_ITEM_ID" = "PSTG_OE_ORDER_LINES_ALL"."INVENTORY_ITEM_ID"
                    AND UPPER("STG_DIM_PRODUCTS_INVENTORY"."ITEM_TYPE") = 'SERVICE'
                    AND "STG_DIM_PRODUCTS_INVENTORY"."SYSTEM_CURRENT_FLAG" = 'Y'
                JOIN {{ ref('PERSISTENT_STAGING_ORACLE', 'PSTG_MTL_PARAMETERS') }} "PSTG_MTL_PARAMETERS"
                    ON "PSTG_MTL_PARAMETERS"."ORGANIZATION_ID" = "PSTG_OE_ORDER_HEADERS_ALL"."SHIP_FROM_ORG_ID"
                    AND "PSTG_MTL_PARAMETERS"."SYSTEM_CURRENT_FLAG" = 'Y'
                JOIN {{ ref('PERSISTENT_STAGING_ORACLE', 'PSTG_ERP_ORDER_SLAS') }} "PSTG_ERP_ORDER_SLAS"
                    ON "PSTG_ERP_ORDER_SLAS"."HEADER_ID" = "PSTG_WEB_ORDER_HEADERS"."HEADER_ID"
                    AND "PSTG_ERP_ORDER_SLAS"."SYSTEM_CURRENT_FLAG" = 'Y'
                LEFT JOIN {{ ref('TRANSFORM_DIMENSION', 'STG_DIM_FULFILLMENT_CONSUMER') }} "STG_DIM_FULFILLMENT_CONSUMER"
                    ON "STG_DIM_FULFILLMENT_CONSUMER"."SITE_USE_ID" = "PSTG_OE_ORDER_HEADERS_ALL"."SHIP_TO_ORG_ID"
                WHERE "PSTG_OE_ORDER_HEADERS_ALL"."SYSTEM_CURRENT_FLAG" = 'Y'
                GROUP BY "ORDER_NUMBER"
                    , "PSTG_OE_ORDER_HEADERS_ALL"."ATTRIBUTE2"
                    , "BILL_ORDER_TYPE"
                    , "SHIP_DATE_3"
                    , "PSTG_OE_ORDER_HEADERS_ALL"."ORIG_SYS_DOCUMENT_REF"
                    , "SHIP_DATE"
                    , "PACKAGE_ID"
                    , "TRACKING_CODE"
                    , "SHIP_FROM_FULFILLMENT_CENTER"
                    , "PACKAGE_WEIGHT"
                    , "WINE_BOTTLES_IN_CONTAINER"
                    , "GIFT_SETS_IN_CONTAINER"
                    , "OTHER_ITEMS_IN_CONTAINER"
                    , "TOTAL_ITEMS_IN_CONTAINER"
                    , "SHIP_TO_ORGANIZATION_ID"
                    , "SHIP_FROM_ORGANIZATION_ID"
                    , "SERVICE_LEVEL_ID"
                    , "CARRIER"
                    , "SHIPPING_ZONE_ID"
                    , "SLA_DATE"
                    , "STATUS_CODE"
                    , "SOLD_TO_ORGANIZATION_ID"
                    , "PACKAGE_TYPE"
                    , "SHIP_TO_STATE"
            name: STG_FACT_ORDER_HEADER
            noLinkRefs: []
      name: STG_FACT_ORDER_HEADER
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: "5630"
