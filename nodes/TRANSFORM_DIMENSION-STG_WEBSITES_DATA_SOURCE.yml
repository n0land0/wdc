steps:
  STG_WEBSITES_DATA_SOURCE-5660:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: |-
        This table is taking all website ids from eComemrce Orders tables and the Recurly table. This is to ensure we are capturing as many websites as possible from source data.

        This is a temporary table until the client MDM table is built out.
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: TRANSFORM_DIMENSION
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: "624935"
              stepCounter: "5660"
            dataType: VARCHAR(16777216)
            description: ""
            hashDetails: null
            name: WEBSITE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "371009"
                    stepCounter: "5570"
                transform: Upper("STG_WEBSITE_UNION"."WEBSITE_ID")
          - columnReference:
              columnCounter: "624936"
              stepCounter: "5660"
            dataType: VARCHAR(16777216)
            description: ""
            name: DATA_SOURCE_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "179807"
                    stepCounter: "5080"
                transform: CASE WHEN "STG_DIM_ORDERS_UNION"."DATA_SOURCE_NAME" = 'ibg' THEN 'IBG' ELSE "STG_DIM_ORDERS_UNION"."DATA_SOURCE_NAME" END
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7e9e3afb-1d27-4b52-905c-0fbe9ea585d9
              stepCounter: "5660"
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: STG_WEBSITES_DATA_SOURCE_ROW_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: ROW_NUMBER() OVER (PARTITION BY Upper("STG_WEBSITE_UNION"."WEBSITE_ID") ORDER BY "STG_DIM_ORDERS_UNION"."DATA_SOURCE_NAME")
            systemColumnType: None
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              STG_DIM_ORDERS_UNION: "5080"
              STG_WEBSITE_UNION: "5570"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: TRANSFORM_DIMENSION
                nodeName: STG_DIM_ORDERS_UNION
              - locationName: TRANSFORM_DIMENSION
                nodeName: STG_WEBSITE_UNION
            join:
              joinCondition: |-
                FROM {{ ref('TRANSFORM_DIMENSION', 'STG_WEBSITE_UNION') }} "STG_WEBSITE_UNION"
                LEFT JOIN {{ ref('TRANSFORM_DIMENSION', 'STG_DIM_ORDERS_UNION') }} "STG_DIM_ORDERS_UNION"
                    ON "STG_WEBSITE_UNION"."WEBSITE_ID" = "STG_DIM_ORDERS_UNION"."WEBSITE_ID"
                QUALIFY STG_WEBSITES_DATA_SOURCE_ROW_NUMBER = 1    
            name: STG_WEBSITES_DATA_SOURCE
            noLinkRefs: []
      name: STG_WEBSITES_DATA_SOURCE
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: "5660"
