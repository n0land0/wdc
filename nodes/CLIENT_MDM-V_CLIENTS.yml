steps:
  V_CLIENTS-5677:
    operation:
      config:
        insertStrategy: UNION
        postSQL: ""
        preSQL: ""
        selectDistinct: false
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: CLIENT_MDM
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: "625446"
              stepCounter: "5677"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: CLIENT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624160"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625447"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: COMPANY_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624161"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625448"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: NETSUITE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624162"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625449"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: NETSUITE_PARENT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624163"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625450"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: NETSUITE_GRANDPARENT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624164"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625455"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: RECURLY_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624168"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625452"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: RECURLY_PARENT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625060"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625451"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: RECURLY_WEB_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624165"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625453"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: WHEN TENANT_ID IS ADDED TO RECURLY ACCOUNT_HISTORY TABLE, THIS SOURCE COLUMN WILL NEED TO BE MAPPED TO THE TENANT_ID COLUMN.
            hashDetails: null
            name: ANWD_TENANT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624166"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625454"
              stepCounter: "5677"
            dataType: VARCHAR(1020)
            description: ""
            hashDetails: null
            name: NETSUITE_EXTERNAL_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624167"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625457"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: ECOMM_WEBSITE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624170"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625458"
              stepCounter: "5677"
            dataType: VARCHAR(16777216)
            description: ""
            hashDetails: null
            name: ECOMM_WEBSITE_GROUP_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624171"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625456"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: FF_CUSTOMER_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624169"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625461"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: SALESFORCE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624174"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625459"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: SALESFORCE_PARENT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624172"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625460"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: SALESFORCE_ACCOUNT_NUM
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624173"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625463"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: HUBSPOT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624176"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625462"
              stepCounter: "5677"
            dataType: NUMBER(18,0)
            description: ""
            hashDetails: null
            name: FINANCE_XREF_ROW_NUM
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624175"
                    stepCounter: "5624"
                transform: ""
          - columnReference:
              columnCounter: "625473"
              stepCounter: "5677"
            dataType: VARCHAR(100)
            description: ""
            hashDetails: null
            name: PARTNER_ENTITY_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625395"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625472"
              stepCounter: "5677"
            dataType: VARCHAR(100)
            description: ""
            hashDetails: null
            name: ENTERPRISE_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625391"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625474"
              stepCounter: "5677"
            dataType: VARCHAR(100)
            description: ""
            hashDetails: null
            name: WEB_ORDER_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625396"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625475"
              stepCounter: "5677"
            dataType: VARCHAR(100)
            description: ""
            hashDetails: null
            name: FULFILL_INVOICE_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625397"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625476"
              stepCounter: "5677"
            dataType: VARCHAR(100)
            description: ""
            hashDetails: null
            name: ECOMMERCE_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625398"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625477"
              stepCounter: "5677"
            dataType: VARCHAR(100)
            description: ""
            hashDetails: null
            name: FULFILLMENT_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625399"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625478"
              stepCounter: "5677"
            dataType: VARCHAR(100)
            description: ""
            hashDetails: null
            name: MARKETPLACE_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625400"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625479"
              stepCounter: "5677"
            dataType: VARCHAR(100)
            description: ""
            hashDetails: null
            name: TEST_ACCT_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625401"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625482"
              stepCounter: "5677"
            dataType: VARCHAR(20)
            description: ""
            hashDetails: null
            name: ACTIVE_WEBSITE_ORDER_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625442"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625483"
              stepCounter: "5677"
            dataType: VARCHAR(20)
            description: ""
            hashDetails: null
            name: ACTIVE_FULFILLMENT_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625443"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625493"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            name: MAX_WEB_ORDER_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625491"
                    stepCounter: "5676"
                transform: ""
          - columnReference:
              columnCounter: "625492"
              stepCounter: "5677"
            dataType: VARCHAR(256)
            description: ""
            name: MAX_FF_INVOICE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625490"
                    stepCounter: "5676"
                transform: CAST("T_DIM_MDM_ENTITY"."MAX_FF_INVOICE_DATE" AS DATE)
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              MDM_ENTITY_HISTORY: "5624"
              T_DIM_MDM_ENTITY: "5676"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: CLIENT_MDM
                nodeName: MDM_ENTITY_HISTORY
              - locationName: CLIENT_MDM
                nodeName: T_DIM_MDM_ENTITY
            join:
              joinCondition: |-
                FROM {{ ref('CLIENT_MDM', 'MDM_ENTITY_HISTORY') }} "MDM_ENTITY_HISTORY"
                INNER JOIN {{ ref('CLIENT_MDM', 'T_DIM_MDM_ENTITY') }} "T_DIM_MDM_ENTITY"
                ON "MDM_ENTITY_HISTORY"."ENTITY_ID" = "T_DIM_MDM_ENTITY"."ENTITY_ID"
                    AND "T_DIM_MDM_ENTITY"."SYSTEM_CURRENT_FLAG" = 'Y'
                    AND "T_DIM_MDM_ENTITY"."CLIENT_ELIGIBLE_FLAG" = 'Y'
                WHERE "MDM_ENTITY_HISTORY"."SYSTEM_CURRENT_FLAG" = 'Y'
            name: V_CLIENTS
            noLinkRefs: []
      name: V_CLIENTS
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: "5677"
