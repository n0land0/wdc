steps:
  STG_ORDER_PAYMENTS-a808bdbd-4cb7-4281-a48b-26254dfd3faf:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationName: TRANSFORM_DIMENSION
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 4e3c869c-6358-4ffc-a6f7-f8fd22fdac58
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: OP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ffd3ff4c-0f9e-4c1c-8358-edbf903cad99
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 8dd38f7a-90c1-4a69-a953-a497a68cea4f
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: TIMESTAMP_TRACK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9f54c334-2e36-48bf-877e-745b4ea8466f
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 1fbdda0d-956a-415d-9312-9e2f38eee85f
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: ORDERPAYMENTID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 097ffed9-9fc8-43aa-8f46-f6b58957c51e
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: baaccb37-6cdc-4281-a485-aac58d7775f4
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: ORDERID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 01331199-9a1d-4356-8086-db58ae06431e
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 557cb77e-969c-42d6-89c1-0d7443f94f1e
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d83fefd-66f0-4924-b3de-635d18909d74
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 4684f640-bae2-4002-8f14-58b461bdda58
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: ORDERPAYMENTDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0f22ece8-816e-40bb-b783-03e2630bc8e7
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: f01a6f05-2bc3-4ffa-9f21-dd95cf0da4c5
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: BOOLEAN
            description: ""
            name: ISSUCCESSFUL
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6ad6d46b-6177-4702-a10e-80fd83187d81
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: bea3cb48-2656-4383-a9db-75e1361fad99
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: AUTHCODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 43b4290e-fb97-420b-a04b-a3d60ba23dd8
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: eaea7a4a-37d1-46a0-8178-d100776e0a64
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: TRANSACTIONID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a89ae066-1374-49c9-a7a3-1ff5321ab28e
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: d2329c8d-8831-4095-9ad2-5d3d4c588522
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: REASONCODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7ab9be0a-bd28-4ee4-a629-4e8d132643b1
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 299e2196-8b4e-4b29-b917-ef7d22324922
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: NUMBER(18,2)
            description: ""
            name: AMOUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bc7959d2-d80f-46c1-be49-edf35e80e0be
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: fae8bf62-5f21-4d18-a9f8-3b590e574788
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: RESULTBLOB
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f077f209-dd7b-454c-84a0-10d7a599fdfc
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 8c4d919a-8d08-4e44-9fa9-f4bc9a8f756d
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: CARDNUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 297195df-532c-4f6c-b290-58eb9d7736ce
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 3dab15dc-d48a-41fa-a626-7f418bd88616
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: CARDEXPIRYMO
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 00c52647-543c-4fc9-8399-56c89dbd53ac
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 403c8a95-c931-4a73-a660-0af88895d353
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: CARDEXPIRYYR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 918b28fc-523b-4b61-8022-3e5d7477b757
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 70d8b4d0-fd44-4ec7-8bb4-8a034e3bcffa
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: PAYMENTTERMINALID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d999b8b7-4bd1-4029-a334-3e1ef59a33f8
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 04588aa5-bc26-432b-9640-e535ce2f3a72
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: ORDERTENDERID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0286e079-1c8e-45b1-b0cd-11348f1456ad
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: dc309a11-f40b-41a2-8335-ce05c9a652db
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: GATEWAY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8fee9ebd-8f97-4e7f-8455-16ec511a196e
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: 294c3729-0e9e-4c99-8f34-65b1ef5fc483
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: GATEWAYUSERNAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 341a1b1c-beda-4927-a067-4ab6b79a0756
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - columnReference:
              columnCounter: f9f7552e-ca29-473e-a04b-0679ab30dd30
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            dataType: VARCHAR(16777216)
            description: ""
            name: DATA_SOURCE_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 74a88c58-23a4-4c03-8685-340eaabdd8a9
                    stepCounter: 160232b4-129a-4514-b750-036cbdac391e
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: db38d7db-87b8-4e23-bd0a-1b4ce811c2f7
              stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: CURRENT_RECORD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: row_number() over (partition by ORDERPAYMENTID order by ORDERPAYMENTDATE DESC)
            systemColumnType: None
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCES_ECOMMERCE_EXTENDED_CWD
                nodeName: ORDER_PAYMENTS_DELTA_DATA
            join:
              joinCondition: |-
                FROM {{ ref('SOURCES_ECOMMERCE_EXTENDED_CWD', 'ORDER_PAYMENTS_DELTA_DATA') }} "ORDER_PAYMENTS_DELTA_DATA"
                QUALIFY CURRENT_RECORD = 1
            name: STG_ORDER_PAYMENTS
            noLinkRefs: []
      name: STG_ORDER_PAYMENTS
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: a808bdbd-4cb7-4281-a48b-26254dfd3faf
