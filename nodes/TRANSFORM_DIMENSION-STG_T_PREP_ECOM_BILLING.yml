steps:
  STG_T_PREP_ECOM_BILLING-3933:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: TRANSFORM_DIMENSION
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: "96438"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: UUID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54907"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96451"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: DESCRIPTION
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54920"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96449"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: CURRENCY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54918"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96457"
              stepCounter: "3933"
            dataType: BOOLEAN
            description: ""
            hashDetails: null
            name: TAXABLE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54926"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96446"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: ACCOUNTING_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54915"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96447"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: PRODUCT_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54916"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96459"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: TAX_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54928"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96445"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: ORIGIN
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54914"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96460"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: TAX_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54929"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96461"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: TAX_REGION
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54930"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96462"
              stepCounter: "3933"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: TAX_RATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54931"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96464"
              stepCounter: "3933"
            dataType: BOOLEAN
            description: ""
            hashDetails: null
            name: REFUND
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54933"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96444"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: INVOICE_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54913"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "123614"
              stepCounter: "3933"
            config: {}
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            keyColumnType: None
            name: COMPANY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54683"
                    stepCounter: "3204"
                transform: ""
            systemColumnType: None
            type: Column
          - columnReference:
              columnCounter: "371606"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: PREVIOUS_INVOICE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54844"
                    stepCounter: "3211"
                transform: ""
          - columnReference:
              columnCounter: "371605"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: LINE_ITEM_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54898"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "99025"
              stepCounter: "3933"
            config: {}
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            keyColumnType: None
            name: LINE_ITEM_STATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54909"
                    stepCounter: "3213"
                transform: ""
            systemColumnType: None
            type: Column
          - columnReference:
              columnCounter: "371601"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: LINE_ITEM_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54908"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "99030"
              stepCounter: "3933"
            config: {}
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            isChangeTracking: true
            keyColumnType: None
            name: NET_TERMS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54851"
                    stepCounter: "3211"
                transform: ""
            systemColumnType: None
            type: Column
          - columnReference:
              columnCounter: "623917"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: WEBSITE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54674"
                    stepCounter: "3204"
                transform: ""
          - columnReference:
              columnCounter: "99031"
              stepCounter: "3933"
            config: {}
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            isChangeTracking: true
            keyColumnType: None
            name: PO_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54850"
                    stepCounter: "3211"
                transform: ""
            systemColumnType: None
            type: Column
          - columnReference:
              columnCounter: "99032"
              stepCounter: "3933"
            config: {}
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            isChangeTracking: true
            keyColumnType: None
            name: COLLECTION_METHOD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54849"
                    stepCounter: "3211"
                transform: ""
            systemColumnType: None
            type: Column
          - columnReference:
              columnCounter: "371603"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: INVOICE_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54845"
                    stepCounter: "3211"
                transform: ""
          - columnReference:
              columnCounter: "371604"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: INVOICE_STATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54847"
                    stepCounter: "3211"
                transform: ""
          - columnReference:
              columnCounter: "96448"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: CREDIT_REASON_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54917"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96458"
              stepCounter: "3933"
            dataType: BOOLEAN
            description: ""
            hashDetails: null
            name: TAX_EXEMPT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54927"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96431"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: ACCOUNT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54900"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96432"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: PLAN_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54901"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96433"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: ADD_ON_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54902"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96434"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: INVOICE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54903"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96435"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: PREVIOUS_LINE_ITEM_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54904"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96436"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: ORIGINAL_LINE_ITEM_INVOICE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54905"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96441"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: LEGACY_CATEGORY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54910"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "371607"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: INVOICE_COUNTRY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54860"
                    stepCounter: "3211"
                transform: ""
          - columnReference:
              columnCounter: "96442"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: PLAN_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54911"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96443"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            hashDetails: null
            name: ADD_ON_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54912"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96470"
              stepCounter: "3933"
            dataType: TIMESTAMP_TZ(9)
            description: ""
            hashDetails: null
            name: _FIVETRAN_SYNCED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "54939"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "96477"
              stepCounter: "3933"
            dataType: VARCHAR
            description: ""
            hashDetails: null
            name: SOURCE_SYSTEM
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "55200"
                    stepCounter: "3213"
                transform: ""
          - columnReference:
              columnCounter: "623183"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: CUSTOM_ANWDSTORE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623173"
                    stepCounter: "3204"
                transform: ""
          - columnReference:
              columnCounter: "623184"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: CUSTOM_CLASSIC_WEBSITE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623174"
                    stepCounter: "3204"
                transform: ""
          - columnReference:
              columnCounter: "623185"
              stepCounter: "3933"
            dataType: VARCHAR(256)
            description: ""
            name: PARENT_ACCOUNT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623175"
                    stepCounter: "3204"
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              PSTG_ACCOUNT_HISTORY: "3204"
              PSTG_INVOICE_HISTORY: "3211"
              PSTG_LINE_ITEM_HISTORY: "3213"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: PERSISTENT_STAGING_RECURLY
                nodeName: PSTG_ACCOUNT_HISTORY
              - locationName: PERSISTENT_STAGING_RECURLY
                nodeName: PSTG_INVOICE_HISTORY
              - locationName: PERSISTENT_STAGING_RECURLY
                nodeName: PSTG_LINE_ITEM_HISTORY
            join:
              joinCondition: |-
                FROM {{ ref('PERSISTENT_STAGING_RECURLY', 'PSTG_LINE_ITEM_HISTORY') }} "PSTG_LINE_ITEM_HISTORY"
                left join {{ ref( 'PERSISTENT_STAGING_RECURLY', 'PSTG_INVOICE_HISTORY') }} "PSTG_INVOICE_HISTORY"
                ON  ("PSTG_LINE_ITEM_HISTORY"."INVOICE_ID" = "PSTG_INVOICE_HISTORY"."ID") AND "PSTG_INVOICE_HISTORY"."SYSTEM_CURRENT_FLAG" = 'Y'
                LEFT JOIN {{ ref('PERSISTENT_STAGING_RECURLY', 'PSTG_ACCOUNT_HISTORY') }} "PSTG_ACCOUNT_HISTORY"
                ON ("PSTG_LINE_ITEM_HISTORY"."ACCOUNT_ID" = "PSTG_ACCOUNT_HISTORY"."ID") AND "PSTG_ACCOUNT_HISTORY"."SYSTEM_CURRENT_FLAG" = 'Y'
                where "PSTG_LINE_ITEM_HISTORY"."SYSTEM_CURRENT_FLAG" = 'Y'
            name: STG_T_PREP_ECOM_BILLING
            noLinkRefs: []
      name: STG_T_PREP_ECOM_BILLING
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: "3933"
