steps:
  TMP_FACT_ORDER_HEADER-5641:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: TRANSFORM_FACT
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: "624124"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: ORDER_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623780"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624125"
              stepCounter: "5641"
            dataType: VARCHAR(240)
            description: ""
            hashDetails: null
            name: ORDER_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623643"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624126"
              stepCounter: "5641"
            dataType: VARCHAR(240)
            description: ""
            hashDetails: null
            name: BILL_ORDER_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623658"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624127"
              stepCounter: "5641"
            dataType: VARCHAR(50)
            description: ""
            hashDetails: null
            name: CUSTOMER_ORDER_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623673"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624128"
              stepCounter: "5641"
            dataType: VARCHAR(80)
            description: ""
            hashDetails: null
            name: TRACKING_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623875"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624129"
              stepCounter: "5641"
            dataType: varchar
            description: ""
            hashDetails: null
            name: PACKAGE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623877"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624130"
              stepCounter: "5641"
            dataType: VARCHAR(3)
            description: ""
            hashDetails: null
            name: SHIP_FROM_FULFILLMENT_CENTER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623878"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624131"
              stepCounter: "5641"
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashDetails: null
            name: SHIP_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623876"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624132"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: PACKAGE_WEIGHT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623879"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624133"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: FULFILLMENT_AND_SHIPPING
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623799"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624134"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: TIER_DELIVERY_SERVICES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623806"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624135"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: LINE_HAUL_SERVICES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623851"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624136"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: FULFILLMENT_FUEL_SURCHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623852"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624137"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: LINE_HAUL_FUEL_SURCHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623853"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624138"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: ADDITIONAL_INSERT_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623854"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624139"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: GREETING_CARD_CHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623855"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624140"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: WILL_CALL_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623856"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624141"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SPECIAL_ORDER_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623857"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624142"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: PACKAGING_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623858"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624143"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: CUSTOM_PACKAGING
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623859"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624144"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: FOAM_PACKING_REQUIRED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623860"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624145"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: COOLPACK_PACKAGING_REQUESTED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623861"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624146"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: LIABILITY_COVERAGE_CHARGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623862"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624147"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: OTHER_CHARGES
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623863"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624148"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: TOTAL
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623864"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624149"
              stepCounter: "5641"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: WINE_BOTTLES_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623865"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624150"
              stepCounter: "5641"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: GIFT_SETS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623866"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624151"
              stepCounter: "5641"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: OTHER_ITEMS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623867"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624152"
              stepCounter: "5641"
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: TOTAL_ITEMS_IN_CONTAINER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623868"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624153"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SHIP_TO_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623870"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624154"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SHIP_FROM_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623871"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624155"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SERVICE_LEVEL_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623872"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624156"
              stepCounter: "5641"
            dataType: VARCHAR
            description: ""
            hashDetails: null
            name: CARRIER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623873"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624157"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: SHIPPING_ZONE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "623874"
                    stepCounter: "5630"
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "624231"
              stepCounter: "5641"
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: ALT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: COALESCE("STG_FACT_ORDER_HEADER"."TRACKING_CODE", "STG_FACT_ORDER_HEADER"."CUSTOMER_ORDER_ID")
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "624158"
              stepCounter: "5641"
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: ORDER_ROW_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: ROW_NUMBER() OVER (PARTITION BY "ALT_ID" || "PACKAGE_ID" ORDER BY "SHIP_DATE")
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: "624159"
              stepCounter: "5641"
            config: {}
            dataType: VARCHAR(10)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: ACTIVE_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: CASE WHEN "ORDER_ROW_NUMBER" = 1 THEN 'Y' WHEN "ORDER_ROW_NUMBER" <> 1 THEN 'N' ELSE 'ERROR' END
            systemColumnType: None
            transform: ""
          - columnReference:
              columnCounter: "624485"
              stepCounter: "5641"
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: SLA_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624416"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624486"
              stepCounter: "5641"
            dataType: VARCHAR(30)
            description: ""
            name: STATUS_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624417"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624647"
              stepCounter: "5641"
            dataType: FLOAT
            description: ""
            name: SOLD_TO_ORGANIZATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624646"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "624652"
              stepCounter: "5641"
            dataType: VARCHAR(30)
            description: ""
            name: PACKAGE_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "624651"
                    stepCounter: "5630"
                transform: ""
          - columnReference:
              columnCounter: "625437"
              stepCounter: "5641"
            dataType: VARCHAR
            description: ""
            name: SHIP_TO_STATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "625435"
                    stepCounter: "5630"
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              STG_FACT_ORDER_HEADER: "5630"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: TRANSFORM_FACT
                nodeName: STG_FACT_ORDER_HEADER
            join:
              joinCondition: |-
                FROM {{ ref('TRANSFORM_FACT', 'STG_FACT_ORDER_HEADER') }} "STG_FACT_ORDER_HEADER"
                QUALIFY "ACTIVE_FLAG" = 'Y'
            name: TMP_FACT_ORDER_HEADER
            noLinkRefs: []
      name: TMP_FACT_ORDER_HEADER
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: "5641"
